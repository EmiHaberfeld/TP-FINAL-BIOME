---
title: "Trabajo Pr치ctico Final  \nBiometr칤a II - 2021"
author: "Mat칤as Alem치n, Milagros Azcueta, Manuel Fiz, Emilia Haberfeld, Diego Kafer, Ilan Shalom"
date: "21/10/2021"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.


# Introducci칩n
Breve y con el 칰nico fin de dar el contexto necesario para entender el an치lisis) y objetivos

# Materiales y m칠todos
Mencionar, adem치s del dise침o experimental o de campo, el o los modelos estad칤sticos propuestos y la estrategia anal칤tica.

# Resultados
Presentar gr치ficos y/o Tablas. Editar lo que sea necesario de formato para que el lector comprenda. Informar medias, magnitud del efecto, letras de significaci칩n cuando corresponda. Supuestos: salvo excepciones, s칩lo mencionarlos y mencionar su cumplimiento. Incluir decisiones metodol칩gicas.

# Discusi칩n o conclusi칩n
P치rrafo de discusi칩n/conclusi칩n.

# Bibliograf칤a
Si corresponde

```{r}
rm(list = ls()) 

# CARGA DE DATOS Y LIBRERIAS
library(reshape2) #melt
library(pastecs)  #tapply
library(ggplot2)
library(plyr)     #revalue
library(readxl)   #excel

setwd("D:/Milagros Azcueta/Documents/GitHub/TP-FINAL-BIOME")
setwd("C:/Users/hecto/Desktop/Il烱/Biome II/TP FINAL/TP-FINAL-BIOME")
datos <- read_excel("datos.xlsx")
str(datos)
datos$Colmena <- as.factor(datos$Colmena)
datos$Semana  <- as.factor(datos$Semana)
datos$ID      <- as.factor(datos$ID)
datos$ANT     <- as.factor(datos$ANT)
datos$PROB    <- as.factor(datos$PROB)
datos$TRAT    <- as.factor(datos$TRAT)
str(datos)
summary(datos)

############################### DESCRIPTIVA ####################################################

################## TESTEO 
# PASAMOS DATOS TEST A LONG:
wide_test <- datos[,c(1,2,3,4,5,6,11,12,13)]
long_test <- melt(wide_test,
                  id.vars = c("Colmena", "Semana", "ID", "ANT", "PROB", "TRAT"),
                  variable.name = "tiempo_test",
                  value.name = "rta")

# PROBABILIDAD DE EXITO SEGUN TRATAMIENTO Y TIEMPO:
prob_exito <- round(tapply(long_test$rta,list(long_test$TRAT,long_test$tiempo_test),mean),2)
prob_exito
# Creamos un data frame con estos valores:
prob_exito_long <- as.data.frame.table(prob_exito)
colnames(prob_exito_long) <- c("Tratamiento","Tiempo_de_testeo","Proporcion_de_exitos")

#Para verlo graficamente:
gp_test <- ggplot(prob_exito_long, aes(x=Tiempo_de_testeo, y=Proporcion_de_exitos, colour=Tratamiento, group=Tratamiento)) +
  geom_line(aes(linetype=Tratamiento), size=.6) +
  geom_point(aes(shape=Tratamiento),size=3) +
  labs(x="Tiempo de testeo",y="Proporcion de exitos",title="Proporcion de exitos en funcion del tiempo y el tratamiento") +
  ylim(0,1) + theme_bw()
  
gp_test

################## ENTRENAMIENTO
# PASAMOS DATOS ENTRENAMIENTO A LONG:
wide_tr <- datos[,c(1,2,3,4,5,6,7,8,9,10)]
long_tr <- melt(wide_tr,
                  id.vars = c("Colmena", "Semana", "ID", "ANT", "PROB", "TRAT"),
                  variable.name = "tiempo_tr",
                  value.name = "rta")

# PROBABILIDAD DE EXITO SEGUN TRATAMIENTO Y TIEMPO:
prob_exito_tr <- round(tapply(long_tr$rta,list(long_tr$TRAT,long_tr$tiempo_tr),mean),2)
prob_exito_tr

prob_exito_long_tr <- as.data.frame.table(prob_exito_tr)
colnames(prob_exito_long_tr) <- c("Tratamiento","Nro_de_ensayo","Proporcion_de_exitos")

#Para verlo graficamente:
gp_tr <- ggplot(prob_exito_long_tr, aes(x=Nro_de_ensayo, y=Proporcion_de_exitos, colour=Tratamiento, group=Tratamiento)) +
  geom_line(aes(linetype=Tratamiento), size=.6) +
  geom_point(aes(shape=Tratamiento),size=3) +
  labs(x="Numero de ensayo",y="Proporcion de exitos",title="Curva de aprendizaje") +
  ylim(0,1) + theme_bw()
  
gp_tr

############################### FIN DESCRIPTIVA ################################################

```

